@using FastSchedule.MVC.ViewModels;
@model HomeViewModel

@{
    @if (Model.StartWeekGap != null)
    {
        for (int i = 0; i < Model.StartWeekGap; i++)
        {
            <div class="grid-item empty-grid">
            </div>
        }
    }

    foreach (var day in Model.Schedule.Days)
    {
        <div id="@day.Date.Year.@day.Date.Month.@day.Date.Day" class="grid-item @((int)day.Date.DayOfWeek == 6 || (int)day.Date.DayOfWeek == 0 ? "weekend-day" : "")
        @(Model.TodayDate == day.Date ? "selected-day" : "")">
            <div class="manage-and-date">
                <p style="@(Model.TodayDate == day.Date ? "text-decoration: underline;" : "")">@day.Date.Day</p>
                <img class="manage-grid" src="/images/icons/info.png" />
            </div>
            @if (day.Tasks != null && day.Tasks.Count() != 0)
            {
                int tasksCount = 0;
                <div class="events">
                @foreach(var task in day.Tasks)
                    {
                        if(tasksCount < 3)
                        {
                            <div style="background-color:#@task.Color" class="task">
                                <p class="event-label">@task.Label</p>
                                @if (task.EventTime != null)
                                {
                                    <p class="event-time">@task.EventTime</p>
                                }
                            </div>
                            tasksCount++;
                        }
                        else
                        {
                            int remainsTasks = day.Tasks.Count() - 3;
                            <div style="background-color:#9ed7e6" class="task">
                                <p class="event-label">И ещё @remainsTasks</p>
                            </div>
                            break;
                        }
                    }
                </div>
            }
        </div>
    }
}